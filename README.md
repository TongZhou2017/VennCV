# VennCV - 科研项目管理系统

一个使用 Rust 和 egui 构建的本地 GUI 应用程序，用于个人科研项目管理。

## 功能特性

- **用户登录系统**: 
  - 用户选择下拉框，快速选择已有用户
  - 创建新用户功能，图形界面创建用户
  - 简单的用户认证机制
  - 每个用户独立的数据存储路径
- **数据表系统**: 左侧面板显示所有项目列表，支持选择和编辑
- **可视化交互界面**: 
  - 大圈表示学科领域（研究方向）
  - 小圈表示具体项目
  - 箭头表示项目间的关系（实线/虚线）
  - 颜色表示项目完成状态
  - 支持拖拽和缩放操作
- **属性编辑面板**: 右侧面板用于编辑选中项目的属性
- **数据持久化**: 支持将数据保存为 JSON 格式，并可加载

## 版本信息

**当前版本**: v0.4.2

v0.4.2 版本快捷键建立关系：
- Command+点击另一个项目建立实线箭头
- Command+Shift+点击建立虚线箭头

v0.4.1 版本领域选择自动布局：
- 选择/取消领域后自动调整布局，无需点击重新布局

v0.4.0 版本使用物理引擎优化布局：
- 物理引擎思想解决项目圆圈重叠问题
- 圆圈之间、圆圈与箭头之间相互排斥
- 项目过多时自动扩展领域大圆圈大小

v0.3.5 版本添加领域拖拽排序：
- 领域编辑栏添加行首序号（1=上，2=左下，3=右下）
- 支持拖拽改变领域顺序，自动重新布局并二次检验
- 新项目位置选择最空白区域，拖拽到错误位置自动修正

v0.3.4 版本优化间距：
- 项目圆圈间距从8像素增加到15像素
- 箭头避让距离从+10像素增加到+25像素

v0.3.3 版本优化项目布局：
- 项目圆圈保持距离不重叠（至少8像素间距）
- 项目位置避开其他项目间的箭头路径

v0.3.2 版本优化领域文字位置：
- 领域文字不进入大圆圈内
- 领域文字不超出可视化窗口边界

v0.3.1 版本添加位置验证与自动修正：
- 加载数据时自动检查并修正错误位置
- 拖拽结束后自动移动到整个圆圈都在正确区域的最近位置
- 重置布局只对位置不正确的项目生效

v0.3.0 版本优化了项目位置计算并添加拖拽功能：
- 修复单领域项目位置计算，避免放置在交叉区域
- 修复多领域交集位置计算，远离非目标领域，避免落入未选中领域
- 领域存储改为IndexMap，保持顺序固定
- 实现项目圆圈交互式拖拽，可直接拖动项目到任意位置

v0.2.18 版本添加了缩放按钮：
- 工具栏新增放大、缩小、重置缩放按钮

v0.2.17 版本适配了macOS快捷键习惯：
- Command+S保存、Command+Z撤销、Command+Shift+Z重做
- Command+N新建项目、Command+Tab工具栏模式

v0.2.16 版本增强了键盘快捷键：
- 登录界面回车键登录
- Command+Tab进入工具栏模式，Tab/Shift+Tab切换按钮
- 使用consume_key确保Tab同时只控制一个元素

v0.2.15 版本添加了Esc取消选中功能：
- 按Esc键取消选中项目，恢复到无选中状态

v0.2.14 版本修复了保存按钮样式：
- 保存按钮取消默认蓝色选中状态

v0.2.13 版本改进了项目列表显示：
- 项目边栏添加行号（1., 2., 3.等）
- 新建项目时确保ID不与已有项目冲突

v0.2.11 版本优化了项目面板领域编辑功能：
- 选中项目后可直接编辑领域（添加/重命名/删除）
- 无需切换到领域管理面板即可管理领域

v0.2.10 版本优化了标签输入框：
- 将添加标签的输入文本框宽度改为固定200像素

v0.2.9 版本添加了可视化图例功能：
- 在可视化界面右上角添加图例显示
- 展示项目状态颜色含义（5种状态）
- 展示完成度颜色含义（0%、50%、100%）
- 使用半透明背景，不遮挡可视化内容
- 支持拖拽调整图例位置
- 双击图例打开设置对话框，可显示/隐藏图例或重置位置

v0.2.8 版本修复了属性面板宽度问题：
- 修复选中项目后属性面板自动变大的问题
- 添加最小宽度（200px）和最大宽度（400px）限制
- 确保属性面板不会因为内容增多而自动扩展

v0.2.7 版本进行了布局优化与功能增强：
- 优化面板布局，可视化面板初始面积最大
- 工具栏添加新建/删除项目按钮
- 属性面板添加领域管理功能（编辑/添加/删除）
- 新用户的领域信息也是空的

v0.2.6 版本进行了UI优化与初始数据管理：
- 移除属性面板宽度限制，可以自由拖动调整
- 优化标签下拉列表，在光标选中文本框时立即显示
- admin用户提供复杂初始数据用于展示功能
- 新用户不提供真实初始数据，使用空数据

v0.2.5 版本进行了UI细节修复与功能完善：
- 修复属性面板宽度问题，添加最小和最大宽度限制
- 修复撤销、重做图标显示为方块的问题
- 修复状态文本显示问题，将"稳步做"改为"进行中"
- 修复标签下拉列表不显示的问题
- 修复所属领域无法勾选修改的问题

v0.2.3 版本进行了UI交互优化和功能完善：
- 修复标签输入回车没反应的问题，实现类似飞书的效果
- 将背景颜色设置移到设置对话框，更易访问
- 勾选所属领域后自动更新项目位置，无需手动操作
- 优化领域文字位置，避免重叠和落在其他圆圈内部
- 移除属性面板保存按钮，实时更新项目数据
- 添加工具栏，提供保存、撤销、重做等快捷操作

v0.2.2 版本修复了用户文件路径混乱问题：
- 修复切换用户后 `last_edited_file` 指向其他用户文件的问题
- 添加文件路径验证，确保只更新属于当前用户的文件
- 切换用户时清除当前文件路径，避免跨用户文件混乱

v0.2.1 版本参考VSCode/Cursor设计风格，进行了UI重构：
- VSCode风格主题系统（Light+/Dark+）
- 更专业、更简洁的视觉设计
- 更紧凑的布局和间距
- 侧边栏文件树风格
- 属性面板VSCode风格
- 优化的代码结构

v0.2.0 版本进行了全面的UI现代化升级，包括：
- 统一的现代化主题系统
- 优化的登录界面和对话框
- 更精致的侧边栏面板
- 改进的按钮和控件样式
- 更好的视觉层次和用户体验

## 项目状态

- 🟢 **已发表** (绿色): Published
- 🔵 **投稿中** (蓝色): Submitted  
- 🔴 **优先做** (红色): HighPriority
- 🟠 **稳步做** (橙色): SteadyProgress
- ⚪ **待启动** (白色): ToBeStarted

## 构建和运行

### 前置要求

- Rust 工具链 (rustc, cargo)
- 推荐使用 Rust 1.70 或更高版本

### 构建

```bash
cargo build --release
```

### 运行

```bash
cargo run
```

或者运行发布版本：

```bash
cargo run --release
```

## 使用说明

1. **登录**: 
   - 启动应用后，从下拉框选择已有用户，或点击"创建用户"创建新用户
   - 选择用户后输入密码即可登录
   - 首次使用会自动创建默认配置（admin/admin）
   - 登录成功后自动加载最近编辑的文件（如果存在）

2. **查看项目**: 
   - 左侧面板显示所有项目列表
   - 点击项目名称可选中并查看详情

3. **编辑项目**:
   - 在右侧属性面板中编辑项目信息
   - 可以修改名称、描述、状态和所属领域
   - 点击"保存"按钮保存更改

4. **可视化操作**:
   - 拖拽画布可以平移视图（内容限制在窗口内，不会拖出窗口）
   - 鼠标滚轮可以缩放视图
   - 点击项目圆圈可以选中项目

5. **数据管理**:
   - 通过"文件"菜单可以加载和保存数据
   - 数据以 JSON 格式存储
   - 每个用户有独立的数据存储路径
   - 登录后自动加载最近编辑的文件
   - 保存或打开文件时自动更新最近编辑的文件记录

6. **用户管理**:
   - 登录界面可以创建新用户
   - 每个用户自动创建独立的用户目录（users/用户名）
   - 用户数据存储在各自的目录中

7. **快捷键**:
   - **Ctrl+S**: 保存文件
   - **Ctrl+Z**: 撤销操作
   - **Ctrl+Shift+Z / Ctrl+Y**: 重做操作
   - **Ctrl+N**: 新建项目
   - **Tab**: 切换到下一个项目
   - **Shift+Tab**: 切换到上一个项目
   - **Ctrl+Plus / Ctrl+=**: 放大可视化图
   - **Ctrl+Minus**: 缩小可视化图
   - **Ctrl+0**: 重置缩放

8. **应用设置**:
   - 通过"文件"菜单中的"设置"选项打开设置对话框
   - 可以配置自动保存、可视化样式、历史记录等选项
   - 设置保存到 `app_settings.yaml` 文件
   - 设置立即生效，无需重启应用

9. **项目关系管理**:
   - 在属性编辑面板中可以查看和管理项目关系
   - 支持滚动查看多条关系
   - 每条关系默认折叠，点击展开按钮可查看详细设置
   - 支持为每个关系设置：
     - 目标项目（出向关系）
     - 关系类型（实线/虚线）
     - 线宽（0.5-10.0像素）
     - 颜色（自定义RGBA颜色）
     - 代表意义（标签系统）
   - 标签管理：
     - 点击标签输入框时自动显示现有标签列表
     - 从列表中选择标签即可添加
     - 输入新标签名后按回车键即可创建新标签
     - 支持删除关系中的标签（点击标签上的 ✕ 按钮）
   - 可以添加、删除项目关系
   - 所有设置修改后立即生效，并在可视化中显示
   - 标签在折叠状态下显示，便于快速查看

## 项目结构

```
src/
├── main.rs      # 应用入口
├── app.rs       # 主应用逻辑和 UI
└── models.rs    # 数据模型定义
```

## 技术栈

- **egui**: 即时模式 GUI 框架
- **eframe**: egui 的窗口框架
- **serde**: 序列化/反序列化
- **serde_json**: JSON 支持
- **rfd**: 文件对话框

## 开发计划

- [ ] 增强用户认证系统（密码加密）
- [ ] 支持拖拽项目位置
- [ ] 支持添加/删除项目和关系
- [x] 支持多个用户数据隔离（v0.1.7）
- [x] 用户选择和创建功能（v0.1.8）
- [x] 登录后自动加载最近编辑文件（v0.1.9）
- [x] 拖拽边界限制（v0.1.10）
- [x] 常用快捷键和撤销/重做功能（v0.1.11）
- [x] 菜单栏重新设计（v0.1.12）
- [ ] 导出可视化图片
- [ ] 项目搜索和筛选功能

## 许可证

MIT License

